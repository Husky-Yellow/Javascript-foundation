<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>js模糊查询_精准查询</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- filter()方法用于过滤数组元素。该方法创建一个新数组, 
        其中包含通过所提供函数实现的测试的所有元素。
        filter()不会对空数组进行检测 -->

    <!-- var newArray = arr.filter(callback(element[, index[, array]])[, thisArg])
         callback 用来测试数组的每个元素的函数。返回 true 表示该元素通过测试，保留该元素，false 则不保留。
         thisArg 执行 callback 时，用于 this 的值。 -->



    <!-- find()方法用于返回数组中满足提供的测试函数的第一个元素的值。否则返回 undefined。
            对于空数组，函数是不会执行的。该方法没有改变数组的原始值 -->

    <!-- arr.find(callback[, thisArg])
         callback 在数组每一项上执行的函数。
         thisArg可选 执行回调时用作this 的对象。 -->

    <!-- 相同：find 和 filter 都是不改变原数组的方法，都不会对空数组进行检测。 -->
    <!-- 区别：find只查出第一个符合条件的结果像例子里是直接返回了一个对象而不是数组，而filter返回全部结果仍然是数组 -->



    <!-- indexof()是es5的方法，该方法返回在数组/字符串中可以找到一个给定元素的第一个索引，如果不存在，则返回-1 -->
    <!-- includes()是es6的方法，该方法用来判断一个数组是否包含一个指定的值，根据情况，如果包含则返回 true，否则返回false -->
    <!-- includes()更加完善，且语义化更强 -->
</head>

<body>
    <div id="app">
    </div>
</body>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            message: 'Hello Vue!',
            staff: [ // 测试用的数据
                { name: "April", job: "programmer", age: "18", hobby: "study" },
                { name: "Shawn", job: "student", age: "8", hobby: "study" },
                { name: "Leo", job: "teacher", age: "28", hobby: "play" },
                { name: "Todd", job: "programmer", age: "19", hobby: "sleep" },
                { name: "Scoot", job: "cook", age: "38", hobby: "paintting" },
            ],
        },
        methods: {
            /** 单条件精准查找
             * @param {Object} lists 所有数据
             * @param {string} key 需要查询的数据的键值
             * @param {string} value 需要查询的值
             * **/
            searchKeyValue(lists, key, value) {
                let res = lists.filter(item => item[key] == value);
                console.log(`单条件精准查找${JSON.stringify(res)}`)
                return res
            },
            /** 多条件精准查找
            * @param {Object} lists 所有数据
            * @param {Object} filters 需要查询的数据
            * **/
            searchKeysValue(lists, filters) {
                let key = Object.keys(filters);
                console.log(`多条件精准查找的key${JSON.stringify(key)}`)
                let resArr = lists.filter(item => key.find(k => item[k] == filters[k]))
                console.log(`多条件精准查找的resArr${JSON.stringify(resArr)}`)
            },
            /** 多条件多值精准查找
            * @param {Object} lists 所有数据
            * @param {Object} filters 需要查询的数据
            */
            searchKeysValues(lists, filters) {
                let resArr = [];
                lists.filter((item) => {
                    for (let i in filters) {
                        for (let j of filters[i]) {
                            if (item[i] == j) {
                                resArr.push(item)
                            }
                        }
                        break
                    }
                })
            },

            selectMatchItem(lists, keyWord) {
                let resArr = [];
                lists.filter(item => {
                    for (let i in item) {
                        if (parseInt(item[i] / 10) === keyWord) {
                            resArr.push(item);
                        }
                    }
                })
                return resArr;
            },

            /** indexof()模糊查询
            * @param {Object} lists 所有数据 
            * @param {string} keyWord 查询的关键词
            */
            selectMatchItem(lists, keyWord) {
                let resArr = [];
                lists.filter(item => {
                    for (let i in item) {
                        if (item[i].indexOf(keyWord) >= 0) {
                            resArr.push(item);
                        }
                    }
                })
                return resArr;
            },

            /** indexof()多值模糊查询
            * @param {Object} lists 所有数据
            * @param {Array} keyWord 查询的关键词
            */
            selectMatchItems(lists, keyWords) {
                let resArr = [];
                lists.filter(item => keyWords.find(keyWord => {
                    for (let i in item) {
                        if (item[i].indexOf(keyWord) >= 0) {
                            resArr.push(item);
                        }
                    }
                }))
                return resArr;
            },

            /** includes()模糊查询
            * @param {Object} lists 所有数据
            * @param {Object} keyWord 查询的关键词
            */
            selectMatchItem(lists, keyWord) {
                let resArr = [];
                lists.filter(item => {
                    for (let i in item) {
                        if (item[i].includes(keyWord)) {
                            resArr.push(item);
                        }
                    }
                })
                return resArr;
            },
            /** 正则匹配模糊查询
            * @param {Object} lists 所有数据
            * @param {Object} keyWord 查询的关键词
            */
            selectMatchItem(lists, keyWord) {
                let reg = new RegExp(keyWord);
                let resArr = [];
                lists.filter(item => {
                    for (let i in item) {
                        if (reg.test(item[i])) {
                            resArr.push(item);
                        }
                    }
                })
                return resArr;
            },
        },
        beforeMount() {
            // 函数执行 在 “staff” 对象中查找 “job” 值为 “programmer” 的数据
            this.searchKeyValue(this.staff, `job`, `programmer`);

            // 函数执行 在 “staff” 对象中查找 “name” 值为 “April” 和 “hobby” 值为 “study” 的数据
            // 注：该方法第二个参数是个对象
            let filters = {
                name: "April",
                hobby: "study"
            }
            this.searchKeysValue(this.staff, filters);

            // 函数执行 在 “staff” 对象中查找 “age” 值为 “8”或“18” 和 “hobby” 值为 “play”或“sleep” 的数据
            // 注：该方法第二个参数是个对象,键对应的值是个多值的数组
            let filtersse = {
                age: [8, 18],
                hobby: ["play", "sleep"]
            }
            this.searchKeysValues(this.staff, filtersse);

            // 函数执行 在 “staff” 对象中查找 包含 “coot” 的数据   
            this.selectMatchItem(this.staff, 'coot');

            // 函数执行 在 “staff” 对象中查找年龄个位数为age的数据。
            var staff = [{ age: 10 }, { age: 25 }, { age: 18 }]
            var age = 2;
            this.selectMatchItem(this.staff, age)


            // 函数执行 在 “staff” 对象中查找 包含 “coot”或者“8” 的数据。
            this.selectMatchItems(this.staff, ['odd', '8']);

            // 函数执行 在 “staff” 对象中查找 包含 “coot” 的数据。
            this.selectMatchItem(this.staff, 'coot');

            // 函数执行 在 “staff” 对象中查找 包含 “8” 的数据。
            this.selectMatchItem(this.staff, '8');
        }
    })
</script>

</html>